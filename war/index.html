<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<style>
a:link {
	color: #FF0000;
	text-decoration: none;
}

a:visited {
	color: #00FF00;
	text-decoration: none;
}

a:hover {
	color: #FF00FF;
	text-decoration: none;
}

a:active {
	color: #0000FF;
	text-decoration: underline;
}
</style>
</head>

<body>
	<iframe src="http://1-dot-ninety7-service.appspot.com/login"></iframe>

	<div>
		<div id="pageTileDiv" style="background-color: black; color: white; margin: 20px; padding: 20px; width: 300px; float: left; max-height: 500px;">

			<button type="button">Ban</button>

			<h2 id="pageTitle">
				<a
					href="http://index.hu/x.php?id=inxcl&amp;url=http%3A%2F%2Findex.hu%2Fbelfold%2F2014%2F12%2F11%2Fpedig_a_fidesz_csak_most_jon_az_igazan_nepszerutlen_dolgokkal%2F">Ló-erő,
					érted?</a>
			</h2>

			<p id="pageAbstract">Ló-erő, érted? London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area
				of over 13 million inhabitants.</p>

			<p>
				A Miniszterelnökséget vezető miniszter szerint a kormányellenes tüntetések szervezésében is aktívan részt vettek az amerikaiak. <br> <a
					class="read-more boxedlight" href="http://444.hu/2014/12/22/lazar-az-amerikai-nagykovetseg-atvette-a-magyar-ellenzek-szerepet/">Tovább</a>
			</p>

		</div>
	</div>

	<div id="digestBoard"></div>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script charset="utf-8">
		var pageTileDivElement = document.getElementById("pageTileDiv");

		for (i = 0; i < 5; ++i) {
			$
					.post(
							"http://1-dot-ninety7-service.appspot.com/digest",
							{
								pageNum : i
							},
							function(data, status) {
								for (j = 0; j < data.length; ++j) {
									digestItem = data[j];

									var x = document.createElement("div");
									x
											.setAttribute(
													"style",
													"background-color: black; color: white; margin: 20px; padding: 20px; width: 300px; float: left; max-height: 500px;");
									x.id = "div-" + digestItem.url;

									var banButtonElement = document
											.createElement("button");
									banButtonElement.id = digestItem.url;
									banButtonElement.onclick = function(event) {
										$
												.post(
														"http://1-dot-ninety7-service.appspot.com/voter",
														{
															operation : "ban",
															url : event.srcElement.id
														});
										var child = document
												.getElementById("div-"
														+ event.srcElement.id);
										child.remove();

										alert("banned:" + event.srcElement.id);
									}
									var banButtonElementText = document
											.createTextNode("Ban");
									banButtonElement
											.appendChild(banButtonElementText);
									x.appendChild(banButtonElement);

									var readButtonElement = document
											.createElement("button");
									readButtonElement.id = digestItem.url;
									readButtonElement.onclick = function(event) {
										$
												.post(
														"http://1-dot-ninety7-service.appspot.com/voter",
														{
															operation : "read",
															url : event.srcElement.id
														});

										var child = document
												.getElementById("div-"
														+ event.srcElement.id);
										child.remove();

									}
									var readButtonElementText = document
											.createTextNode("Read");
									readButtonElement
											.appendChild(readButtonElementText);
									x.appendChild(readButtonElement);

									var delButtonElement = document
											.createElement("button");
									delButtonElement.id = digestItem.url;
									delButtonElement.onclick = function(event) {
										$
												.post(
														"http://1-dot-ninety7-service.appspot.com/voter",
														{
															operation : "del",
															url : event.srcElement.id
														});

										var child = document
												.getElementById("div-"
														+ event.srcElement.id);
										child.remove();

									}
									var delButtonElementText = document
											.createTextNode("Del");
									delButtonElement
											.appendChild(delButtonElementText);
									x.appendChild(delButtonElement);

									var titleElement = document
											.createElement("h2");
									var aNode = document.createElement("a");
									aNode.href = digestItem.url;
									var titleText = document
											.createTextNode(digestItem.title);
									aNode.appendChild(titleText);
									titleElement.appendChild(aNode);
									x.appendChild(titleElement);

									console.log("title:", digestItem.title);
									console.log("abstract:",
											digestItem.abstract);

									var abstractElement = document
											.createElement("p");
									var abstractTextNode = document
											.createTextNode(digestItem.abstract);
									abstractElement
											.appendChild(abstractTextNode);
									x.appendChild(abstractElement);

									if (digestItem.keywords != undefined) {
										var keywordsElement = document
												.createElement("p");
										var keywordsTextNode = document
												.createTextNode(digestItem.keywords);
										keywordsElement
												.appendChild(keywordsTextNode);
										x.appendChild(keywordsElement);
									}

									document.getElementById("digestBoard")
											.appendChild(x);
								}
							});
		}
	</script>

</body>
</html>
